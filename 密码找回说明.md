# 🔑 密码管理说明

## 当前用户账号信息

### 测试账号（仅开发环境）
- **邮箱**: test@test.com  
- **密码**: 123456
- **用途**: 本地开发测试

### 生产环境账号
- **密码存储方式**: bcrypt加密存储在数据库中
- **特点**: 密码经过单向加密，无法直接查看原文
- **安全性**: ✅ 高安全性，符合行业标准

---

## 📋 如何找回/重置密码

### 方案1：数据库直接重置（推荐）

如果你有服务器访问权限，可以直接在数据库中重置密码：

```bash
# 1. SSH登录服务器
ssh root@114.55.117.20

# 2. 进入项目目录
cd /opt/wechat-editor-production/server

# 3. 使用Prisma Studio管理数据库
npx prisma studio

# 4. 在浏览器中打开 http://localhost:5555
# 5. 找到User表，找到你的用户
# 6. 修改password字段为以下任意一个已加密的密码：

# 密码: 123456 的bcrypt哈希值
$2b$10$X7j9KZQZxU6qF5nJ4Y8QUeH1vR0Jf3.Wp2YqLkMzNpQx5jZ7sK3yS

# 密码: password 的bcrypt哈希值
$2b$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi

# 7. 保存后即可使用新密码登录
```

### 方案2：使用Node.js脚本重置

创建一个临时重置脚本：

```javascript
// reset-password.js
const bcrypt = require('bcrypt');
const { PrismaClient } = require('@prisma/client');

const prisma = new PrismaClient();

async function resetPassword(email, newPassword) {
  const hashedPassword = await bcrypt.hash(newPassword, 10);
  
  await prisma.user.update({
    where: { email },
    data: { password: hashedPassword }
  });
  
  console.log(`✅ 密码已重置为: ${newPassword}`);
}

// 使用方法
resetPassword('your@email.com', 'newpassword123')
  .then(() => process.exit(0))
  .catch(console.error);
```

**执行：**
```bash
cd /opt/wechat-editor-production/server
node reset-password.js
```

### 方案3：使用bcrypt命令行工具

```bash
# 安装bcrypt-cli
npm install -g bcrypt-cli

# 生成新密码的哈希值
bcrypt-cli "your-new-password"

# 复制生成的哈希值，手动更新到数据库的password字段
```

### 方案4：注册新账号（最简单）

如果之前的账号不重要，可以直接注册一个新账号：

```
1. 使用新的邮箱地址
2. 填写用户名和密码
3. 点击注册
4. 立即可用
```

---

## 🔐 密码安全最佳实践

### ✅ 推荐做法

1. **使用强密码**
   - 至少8位字符
   - 包含大小写字母、数字、特殊字符
   - 示例：`MyP@ssw0rd!2024`

2. **定期更换密码**
   - 每3-6个月更换一次
   - 避免使用相同密码

3. **使用密码管理器**
   - 推荐：1Password, Bitwarden, LastPass
   - 自动生成和存储复杂密码

4. **记录重要信息**
   - 将密码保存在安全的地方
   - 使用加密的笔记本
   - 不要保存在明文文件中

### ❌ 避免做法

1. ❌ 使用简单密码（如：123456, password）
2. ❌ 多个账号使用相同密码
3. ❌ 将密码写在纸上或发送给他人
4. ❌ 在公共设备上保存密码
5. ❌ 使用个人信息作为密码（生日、姓名等）

---

## 📱 忘记密码功能（待开发）

### 计划功能

未来版本将添加以下功能：

1. **邮箱验证重置**
   - 输入注册邮箱
   - 发送验证码到邮箱
   - 验证后设置新密码

2. **安全问题重置**
   - 注册时设置安全问题
   - 忘记密码时回答问题
   - 验证通过后重置

3. **管理员协助重置**
   - 联系管理员
   - 提供身份证明
   - 管理员手动重置

### 实现优先级

- **P0** (紧急): 数据库手动重置
- **P1** (高优先级): 邮箱验证重置
- **P2** (中优先级): 管理员协助
- **P3** (低优先级): 安全问题重置

---

## 🎯 当前推荐方案

### 对于普通用户

**最简单的方法**：
1. 注册新账号
2. 使用密码管理器保存密码
3. 开启浏览器"记住密码"功能

### 对于管理员

**快速重置**：
```bash
# 1键重置脚本
cd /opt/wechat-editor-production/server
cat > reset.js << 'EOF'
const bcrypt = require('bcrypt');
const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

const email = process.argv[2];
const password = process.argv[3] || '123456';

bcrypt.hash(password, 10).then(hash => {
  prisma.user.update({
    where: { email },
    data: { password: hash }
  }).then(() => {
    console.log(`✅ ${email} 的密码已重置为: ${password}`);
    process.exit(0);
  });
});
EOF

# 使用方法
node reset.js your@email.com newpassword123
```

---

## 💡 常见问题

### Q1: 密码忘了怎么办？

**A**: 使用上述任意一种重置方案，推荐方案1（Prisma Studio）最简单。

### Q2: 可以查看原密码吗？

**A**: 不可以。密码经过bcrypt加密，是单向加密，无法解密回原文。这是安全特性。

### Q3: 重置密码会影响已有数据吗？

**A**: 不会。只会修改password字段，不影响用户的文章、设置等数据。

### Q4: 可以让所有用户统一密码吗？

**A**: 技术上可以，但**强烈不推荐**。这严重违反安全规范。

### Q5: 密码可以设置为空吗？

**A**: 不可以。系统要求密码至少6位字符。

---

## 📞 需要帮助？

如果你需要重置密码或遇到问题，可以：

1. **查看本文档** - 90%的问题都有答案
2. **SSH登录服务器** - 直接操作数据库
3. **联系技术支持** - 提供用户邮箱和问题描述

---

## 🔄 更新日志

- **2024-10-18**: 创建密码管理说明文档
- **待定**: 实现邮箱验证重置功能

---

**安全提示**：妥善保管你的密码，不要分享给任何人！ 🔒

